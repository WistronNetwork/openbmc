From 5dafb096db46e185c52d8863fd0b88f89ddd7f74 Mon Sep 17 00:00:00 2001
From: Neal_Chen <neal_chen@wistron.com>
Date: Thu, 6 Apr 2023 17:54:07 +0800
Subject: [PATCH] spi: add user-mode aspeed spi driver

Based on: https://github.com/facebook/openbmc-linux
Commit id: 029a6858eb7cac35f4ba6bb77eb0f151ab2e45d3

Signed-off-by: Neal_Chen <neal_chen@wistron.com>
---
 drivers/spi/Kconfig  | 7 +++++++
 drivers/spi/Makefile | 1 +
 2 files changed, 8 insertions(+)

diff --git a/drivers/spi/Kconfig b/drivers/spi/Kconfig
index 06da8059d0a5..a7d1f86036a9 100644
--- a/drivers/spi/Kconfig
+++ b/drivers/spi/Kconfig
@@ -112,6 +112,13 @@ config SPI_ASPEED_SMC
 	  controller (SPI) for the host firmware. The implementation
 	  only supports SPI NOR.
 
+config SPI_ASPEED_USER
+	tristate "ASPEED SPI Controller (User Mode)"
+	depends on ARCH_ASPEED
+	help
+	  This enables support for the SPI Controller User Mode in
+	  AST24XX, AST25XX and AST26XX SoCs.
+
 config SPI_ATMEL
 	tristate "Atmel SPI Controller"
 	depends on ARCH_AT91 || COMPILE_TEST
diff --git a/drivers/spi/Makefile b/drivers/spi/Makefile
index 3dd0e649be94..6bea7aeddba0 100644
--- a/drivers/spi/Makefile
+++ b/drivers/spi/Makefile
@@ -20,6 +20,7 @@ obj-$(CONFIG_SPI_ALTERA_DFL)		+= spi-altera-dfl.o
 obj-$(CONFIG_SPI_AR934X)		+= spi-ar934x.o
 obj-$(CONFIG_SPI_ARMADA_3700)		+= spi-armada-3700.o
 obj-$(CONFIG_SPI_ASPEED_SMC)		+= spi-aspeed-smc.o
+obj-$(CONFIG_SPI_ASPEED_USER)		+= spi-aspeed-user.o
 obj-$(CONFIG_SPI_ATMEL)			+= spi-atmel.o
 obj-$(CONFIG_SPI_ATMEL_QUADSPI)		+= atmel-quadspi.o
 obj-$(CONFIG_SPI_AT91_USART)		+= spi-at91-usart.o
-- 
2.25.1

