From 216728206ec9a724683d0e472d94f2a20c8d17c3 Mon Sep 17 00:00:00 2001
From: Neal_Chen <neal_chen@wistron.com>
Date: Tue, 6 Jun 2023 11:26:21 +0800
Subject: [PATCH 6/6] Only setup and install SFP related module

Signed-off-by: Neal_Chen <neal_chen@wistron.com>
---
 setup.py | 34 ++--------------------------------
 1 file changed, 2 insertions(+), 32 deletions(-)

diff --git a/setup.py b/setup.py
index 4bcdcb7..b91b5f8 100644
--- a/setup.py
+++ b/setup.py
@@ -1,24 +1,4 @@
-from __future__ import print_function
-import sys
 from setuptools import setup
-import pkg_resources
-from packaging import version
-
-# sonic_dependencies, version requirement only supports '>='
-sonic_dependencies = ['sonic-py-common', 'sonic-config-engine']
-
-for package in sonic_dependencies:
-    try:
-        package_dist = pkg_resources.get_distribution(package.split(">=")[0])
-    except pkg_resources.DistributionNotFound:
-        print(package + " is not found!", file=sys.stderr)
-        print("Please build and install SONiC python wheels dependencies from sonic-buildimage", file=sys.stderr)
-        exit(1)
-    if ">=" in package:
-        if version.parse(package_dist.version) >= version.parse(package.split(">=")[1]):
-            continue
-        print(package + " version not match!", file=sys.stderr)
-        exit(1)
 
 setup(
     name='sonic-platform-common',
@@ -31,15 +11,8 @@ setup(
     maintainer='Joe LeVeque',
     maintainer_email='jolevequ@microsoft.com',
     packages=[
-        'sonic_eeprom',
-        'sonic_led',
-        'sonic_fan',
         'sonic_platform_base',
-        'sonic_platform_base.sonic_eeprom',
-        'sonic_platform_base.sonic_sfp',
-        'sonic_platform_base.sonic_ssd',
-        'sonic_platform_base.sonic_pcie',
-        'sonic_platform_base.sonic_thermal_control',
+        'sonic_platform_base.sonic_py_common',
         'sonic_platform_base.sonic_xcvr',
         'sonic_platform_base.sonic_xcvr.fields',
         'sonic_platform_base.sonic_xcvr.fields.public',
@@ -49,9 +22,6 @@ setup(
         'sonic_platform_base.sonic_xcvr.api.public',
         'sonic_platform_base.sonic_xcvr.codes',
         'sonic_platform_base.sonic_xcvr.codes.public',
-        'sonic_psu',
-        'sonic_sfp',
-        'sonic_thermal',
         'sonic_y_cable',
         'sonic_y_cable.credo',
         'sonic_y_cable.broadcom',
@@ -64,7 +34,7 @@ setup(
         'natsort==6.2.1', # 6.2.1 is the last version which supports Python 2
         'PyYAML',
         'redis',
-    ] + sonic_dependencies,
+    ],
     setup_requires = [
         'pytest-runner',
         'wheel'
-- 
2.25.1

